# ä¸€ã€Urllib

## 1ã€ä»€ä¹ˆæ˜¯äº’è”ç½‘çˆ¬è™«ï¼Ÿ  

* è§£é‡Š1ï¼šé€šè¿‡ä¸€ä¸ªç¨‹åºï¼Œæ ¹æ®Url(http://www.taobao.com)è¿›è¡Œçˆ¬å–ç½‘é¡µï¼Œè·å–æœ‰ç”¨ä¿¡æ¯
* è§£é‡Š2ï¼šä½¿ç”¨ç¨‹åºæ¨¡æ‹Ÿæµè§ˆå™¨ï¼Œå»å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè·å–å“åº”ä¿¡æ¯  

## 2ã€çˆ¬è™«æ ¸å¿ƒ

1. çˆ¬å–ç½‘é¡µï¼šçˆ¬å–æ•´ä¸ªç½‘é¡µ åŒ…å«äº†ç½‘é¡µä¸­æ‰€æœ‰å¾—å†…å®¹
2. è§£ææ•°æ®ï¼šå°†ç½‘é¡µä¸­ä½ å¾—åˆ°çš„æ•°æ® è¿›è¡Œè§£æ
3. éš¾ç‚¹ï¼šçˆ¬è™«å’Œåçˆ¬è™«ä¹‹é—´çš„åšå¼ˆ  

## 3ã€çˆ¬è™«çš„ç”¨é€”ï¼Ÿ  

* æ•°æ®åˆ†æ/äººå·¥æ•°æ®é›†

* ç¤¾äº¤è½¯ä»¶å†·å¯åŠ¨
* èˆ†æƒ…ç›‘æ§
* ç«äº‰å¯¹æ‰‹ç›‘æ§  

## 4ã€çˆ¬è™«åˆ†ç±»

1. é€šç”¨çˆ¬è™«ï¼š
   å®ä¾‹
   	ç™¾åº¦ã€360ã€googleã€sougouç­‰æœç´¢å¼•æ“â€â€â€ä¼¯ä¹åœ¨çº¿
   åŠŸèƒ½
   	è®¿é—®ç½‘é¡µâ€>æŠ“å–æ•°æ®â€>æ•°æ®å­˜å‚¨â€>æ•°æ®å¤„ç†â€>æä¾›æ£€ç´¢æœåŠ¡
   robotsåè®®
   	ä¸€ä¸ªçº¦å®šä¿—æˆçš„åè®®ï¼Œæ·»åŠ robots.txtæ–‡ä»¶ï¼Œæ¥è¯´æ˜æœ¬ç½‘ç«™å“ªäº›å†…å®¹ä¸å¯ä»¥è¢«æŠ“å–ï¼Œèµ·ä¸åˆ°é™åˆ¶ä½œç”¨
   	è‡ªå·±å†™çš„çˆ¬è™«æ— éœ€éµå®ˆ
   ç½‘ç«™æ’å(SEO)

   	1. æ ¹æ®pagerankç®—æ³•å€¼è¿›è¡Œæ’åï¼ˆå‚è€ƒä¸ªç½‘ç«™æµé‡ã€ç‚¹å‡»ç‡ç­‰æŒ‡æ ‡ï¼‰
   	2. ç™¾åº¦ç«ä»·æ’å

   ç¼ºç‚¹

   1. æŠ“å–çš„æ•°æ®å¤§å¤šæ˜¯æ— ç”¨çš„
   2. ä¸èƒ½æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚æ¥ç²¾å‡†è·å–æ•°æ®  

2. èšç„¦çˆ¬è™«

   åŠŸèƒ½

   â€‹	æ ¹æ®éœ€æ±‚ï¼Œå®ç°çˆ¬è™«ç¨‹åºï¼ŒæŠ“å–éœ€è¦çš„æ•°æ®

   è®¾è®¡æ€è·¯

   â€‹	1.ç¡®å®šè¦çˆ¬å–çš„url

   â€‹		å¦‚ä½•è·å–Url

   â€‹	2.æ¨¡æ‹Ÿæµè§ˆå™¨é€šè¿‡httpåè®®è®¿é—®urlï¼Œè·å–æœåŠ¡å™¨è¿”å›çš„htmlä»£ç 

   â€‹		å¦‚ä½•è®¿é—®

   â€‹	3.è§£æhtmlå­—ç¬¦ä¸²ï¼ˆæ ¹æ®ä¸€å®šè§„åˆ™æå–éœ€è¦çš„æ•°æ®ï¼‰

   â€‹		å¦‚ä½•è§£æ  

## 5ã€åçˆ¬æ‰‹æ®µ

1.Userâ€Agentï¼š  

â€‹	User Agentä¸­æ–‡åä¸ºç”¨æˆ·ä»£ç†ï¼Œç®€ç§° UAï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ä¸²å¤´ï¼Œä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿè¯†åˆ«å®¢æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»ŸåŠç‰ˆ
æœ¬ã€CPU ç±»å‹ã€æµè§ˆå™¨åŠç‰ˆæœ¬ã€æµè§ˆå™¨æ¸²æŸ“å¼•æ“ã€æµè§ˆå™¨è¯­è¨€ã€æµè§ˆå™¨æ’ä»¶ç­‰ã€‚
2.ä»£ç†IP
â€‹	è¥¿æ¬¡ä»£ç†
â€‹	å¿«ä»£ç†
â€‹	ä»€ä¹ˆæ˜¯é«˜åŒ¿åã€åŒ¿åå’Œé€æ˜ä»£ç†ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
â€‹		1.ä½¿ç”¨é€æ˜ä»£ç†ï¼Œå¯¹æ–¹æœåŠ¡å™¨å¯ä»¥çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œå¹¶ä¸”ä¹ŸçŸ¥é“ä½ çš„çœŸå®IPã€‚
â€‹		2.ä½¿ç”¨åŒ¿åä»£ç†ï¼Œå¯¹æ–¹æœåŠ¡å™¨å¯ä»¥çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œä½†ä¸çŸ¥é“ä½ çš„çœŸå®IPã€‚
â€‹		3.ä½¿ç”¨é«˜åŒ¿åä»£ç†ï¼Œå¯¹æ–¹æœåŠ¡å™¨ä¸çŸ¥é“ä½ ä½¿ç”¨äº†ä»£ç†ï¼Œæ›´ä¸çŸ¥é“ä½ çš„çœŸå®IPã€‚
3.éªŒè¯ç è®¿é—®
â€‹	æ‰“ç å¹³å°
â€‹		äº‘æ‰“ç å¹³å°
â€‹		è¶…çº§ğŸ¦…
4.åŠ¨æ€åŠ è½½ç½‘é¡µ ç½‘ç«™è¿”å›çš„æ˜¯jsæ•°æ® å¹¶ä¸æ˜¯ç½‘é¡µçš„çœŸå®æ•°æ®
â€‹	seleniumé©±åŠ¨çœŸå®çš„æµè§ˆå™¨å‘é€è¯·æ±‚
5.æ•°æ®åŠ å¯†
â€‹	åˆ†æjsä»£ç   

## 6ã€è¯·æ±‚å¯¹è±¡çš„å®šåˆ¶

```
urllib.request.urlopen() æ¨¡æ‹Ÿæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚
response æœåŠ¡å™¨è¿”å›çš„æ•°æ®
	responseçš„æ•°æ®ç±»å‹æ˜¯HttpResponse
		å­—èŠ‚â€â€>å­—ç¬¦ä¸²
			è§£ç decode
    	å­—ç¬¦ä¸²â€â€>å­—èŠ‚
			ç¼–ç encode
		read() å­—èŠ‚å½¢å¼è¯»å–äºŒè¿›åˆ¶ æ‰©å±•ï¼šrede(5)è¿”å›å‰å‡ ä¸ªå­—èŠ‚
		readline() è¯»å–ä¸€è¡Œ
		readlines() ä¸€è¡Œä¸€è¡Œè¯»å– ç›´è‡³ç»“æŸ
		getcode() è·å–çŠ¶æ€ç 
		geturl() è·å–url
		getheaders() è·å–headers
	urllib.request.urlretrieve(url,æ ¼å¼) ä¸‹è½½æ–‡ä»¶
		è¯·æ±‚ç½‘é¡µ
		è¯·æ±‚å›¾ç‰‡
		è¯·æ±‚è§†é¢‘
```

## 7ã€è¯·æ±‚å¯¹è±¡çš„å®šåˆ¶

UAä»‹ç»ï¼šUser Agentä¸­æ–‡åä¸ºç”¨æˆ·ä»£ç†ï¼Œç®€ç§° UAï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ä¸²å¤´ï¼Œä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿè¯†åˆ«å®¢æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»ŸåŠç‰ˆæœ¬ã€CPU ç±»å‹ã€æµè§ˆå™¨åŠç‰ˆæœ¬ã€‚æµè§ˆå™¨å†…æ ¸ã€æµè§ˆå™¨æ¸²æŸ“å¼•æ“ã€æµè§ˆå™¨è¯­è¨€ã€æµè§ˆå™¨æ’ä»¶ç­‰
è¯­æ³•ï¼šrequest = urllib.request.Request()  

## 8ã€ç¼–è§£ç   

1. getè¯·æ±‚æ–¹å¼ï¼šurllib.parse.quoteï¼ˆï¼‰

```python
egï¼š
import urllib.request
import urllib.parse
url = 'https://www.baidu.com/s?wd='
headers = {
'Userâ€Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like
Gecko) Chrome/74.0.3729.169 Safari/537.36'
} u
rl = url + urllib.parse.quote('å°é‡')
request = urllib.request.Request(url=url,headers=headers)
response = urllib.request.urlopen(request)
print(response.read().decode('utfâ€8'))
```

2. getè¯·æ±‚æ–¹å¼ï¼šurllib.parse.urlencodeï¼ˆï¼‰  

```python
eg:
import urllib.request
import urllib.parse
url = 'http://www.baidu.com/s?'
data = {
'name':'å°åˆš',
'sex':'ç”·',
} d
ata = urllib.parse.urlencode(data)
url = url + data
print(url)
headers = {
'Userâ€Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like
Gecko) Chrome/74.0.3729.169 Safari/537.36'
} r
equest = urllib.request.Request(url=url,headers=headers)
response = urllib.request.urlopen(request)
print(response.read().decode('utfâ€8'))
```

3. postè¯·æ±‚æ–¹å¼  

```python
eg:ç™¾åº¦ç¿»è¯‘
    import urllib.request
    import urllib.parse
    url = 'https://fanyi.baidu.com/sug'
    headers = {
        'userâ€agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like
        Gecko) Chrome/74.0.3729.169 Safari/537.36'
    } 
    keyword = input('è¯·è¾“å…¥æ‚¨è¦æŸ¥è¯¢çš„å•è¯')
    data = {
        'kw':keyword
    } 
    data = urllib.parse.urlencode(data).encode('utfâ€8')
    request = urllib.request.Request(url=url,headers=headers,data=data)
    response = urllib.request.urlopen(request)
    print(response.read().decode('utfâ€8'))
```


æ€»ç»“ï¼špostå’ŒgetåŒºåˆ«ï¼Ÿ

```python
1ï¼šgetè¯·æ±‚æ–¹å¼çš„å‚æ•°å¿…é¡»ç¼–ç ï¼Œå‚æ•°æ˜¯æ‹¼æ¥åˆ°urlåé¢ï¼Œç¼–ç ä¹‹åä¸éœ€è¦è°ƒç”¨encodeæ–¹æ³•
2ï¼špostè¯·æ±‚æ–¹å¼çš„å‚æ•°å¿…é¡»ç¼–ç ï¼Œå‚æ•°æ˜¯æ”¾åœ¨è¯·æ±‚å¯¹è±¡å®šåˆ¶çš„æ–¹æ³•ä¸­ï¼Œç¼–ç ä¹‹åéœ€è¦è°ƒç”¨encodeæ–¹æ³•
```

